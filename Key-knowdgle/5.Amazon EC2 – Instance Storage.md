

## **EBS (Elastic Block Store) Volumes Overview**

**Definition & Core Characteristics:**
- **EBS = Elastic Block Store Volume** - network drive attachable to EC2 instances while running
- **Analogy:** Think of them as a "network USB stick"
- Allows instances to persist data even after termination
- **Network drive** (not physical) - uses network to communicate with instance (slight latency)
- Can be detached and quickly attached to another EC2 instance

**Key Limitations:**
- **One instance at a time** (except multi-attach io1/io2)
- **Bound to specific Availability Zone** (AZ)
- EBS volume in us-east-1a cannot attach to us-east-1b
- To move across AZs, must snapshot first

**Billing & Capacity:**
- Provisioned capacity (size in GBs and IOPS)
- Billed for all provisioned capacity
- Can increase capacity over time
- **Free tier:** 30 GB General Purpose (SSD) or Magnetic per month

## **EBS Delete on Termination Attribute**

**Default Behavior:**
- **Root EBS volume:** Deleted when instance terminates (attribute enabled)
- **Additional EBS volumes:** NOT deleted when instance terminates (attribute disabled)
- Can be controlled via AWS Console/CLI
- **Use case:** Preserve root volume when instance is terminated

## **EBS Volume Types**

**6 Main Types Available:**

### **1. General Purpose SSD (gp2/gp3)**
**Use Cases:** Cost-effective storage, low-latency, system boot volumes, virtual desktops, dev/test environments
**Size Range:** 1 GiB - 16 TiB

**gp3 (Latest Generation):**
- **Baseline:** 3,000 IOPS and 125 MiB/s throughput
- **Max Performance:** Up to 16,000 IOPS and 1,000 MiB/s independently
- **Advantage:** Can increase IOPS independently from storage size

**gp2 (Previous Generation):**
- Small volumes can burst IOPS to 3,000
- **Size-IOPS Link:** 3 IOPS per GB (max 16,000 IOPS at 5,334 GB)
- Performance tied to volume size

### **2. Provisioned IOPS SSD (io1/io2)**
**Use Cases:** Critical business applications, sustained IOPS performance, applications needing >16,000 IOPS, database workloads

**io1:**
- **Size Range:** 4 GiB - 16 TiB
- **Max PIOPS:** 64,000 (Nitro instances) / 32,000 (other instances)
- Can increase PIOPS independently from storage size

**io2 Block Express:**
- **Size Range:** 4 GiB - 64 TiB
- **Sub-millisecond latency**
- **Max PIOPS:** 256,000 with 1,000:1 IOPS:GiB ratio
- **Supports EBS Multi-attach**

### **3. Throughput Optimized HDD (st1)**
**Use Cases:** Big Data, Data Warehouses, Log Processing
- **Size Range:** 125 GiB - 16 TiB
- **Max Throughput:** 500 MiB/s
- **Max IOPS:** 500
- **Cannot be boot volume**

### **4. Cold HDD (sc1)**
**Use Cases:** Infrequently accessed data, lowest cost scenarios
- **Size Range:** 125 GiB - 16 TiB
- **Max Throughput:** 250 MiB/s
- **Max IOPS:** 250
- **Cannot be boot volume**

**Boot Volume Compatibility:**
- **Only gp2/gp3 and io1/io2** can be used as boot volumes
- **HDD types (st1/sc1) cannot** be boot volumes

## **EBS Multi-Attach (io1/io2 family)**

**Capabilities:**
- Attach same EBS volume to multiple EC2 instances in same AZ
- Each instance has full read & write permissions
- **Use Cases:**
  - Higher application availability in clustered Linux applications
  - Applications managing concurrent write operations
- **Limitations:**
  - Up to 16 EC2 instances at a time
  - Must use cluster-aware file system (not XFS, EXT4)
  - Same AZ only

## **EBS Snapshots**

**Core Functionality:**
- **Point-in-time backup** of EBS volume
- Not necessary to detach volume, but recommended
- Can copy snapshots **across AZ or Region**

### **EBS Snapshot Features:**

**1. EBS Snapshot Archive:**
- Move snapshot to "archive tier" - **75% cheaper**
- **Restore time:** 24-72 hours
- Cost optimization for long-term retention

**2. Recycle Bin for EBS Snapshots:**
- Setup rules to retain deleted snapshots
- **Retention period:** 1 day to 1 year
- Recover from accidental deletion

**3. Fast Snapshot Restore (FSR):**
- Force full initialization of snapshot
- **No latency on first use**
- **Cost:** Expensive ($$$)

## **AMI (Amazon Machine Image)**

**Definition & Purpose:**
- **AMI = Amazon Machine Image**
- **Customization** of an EC2 instance
- Pre-package software, configuration, OS, monitoring
- **Faster boot/configuration** time - software pre-packaged

**Regional Scope:**
- Built for **specific region**
- Can be copied across regions

**AMI Types:**
- **Public AMI:** AWS provided
- **Your own AMI:** Custom created and maintained
- **AWS Marketplace AMI:** Third-party created (potentially for sale)

### **AMI Creation Process:**
1. Start EC2 instance and customize it
2. Stop instance (for data integrity)
3. Build AMI (creates EBS snapshots)
4. Launch instances from the AMI

## **EC2 Instance Store**

**High-Performance Alternative:**
- **Hardware disk** (not network drive) attached to EC2 instance
- **Better I/O performance** than EBS
- **Very high IOPS** capabilities

**Important Limitations:**
- **Ephemeral storage** - lose data if instance stopped
- **Risk of data loss** if hardware fails
- **Your responsibility:** Backups and replication

**Use Cases:**
- Buffer/cache/scratch data
- Temporary content
- High-performance computing requiring maximum I/O

## **Amazon EFS (Elastic File System)**

**Key Characteristics:**
- **Managed NFS** (Network File System)
- Can be mounted on **many EC2 instances** simultaneously
- Works with EC2 instances in **multi-AZ**
- **Highly available, scalable, expensive** (3x cost of gp2)
- **Pay-per-use** model

**Technical Specifications:**
- Uses **NFSv4.1 protocol**
- **Linux-based AMI only** (not Windows)
- **POSIX file system** with standard file API
- **Security group** controls access
- **KMS encryption** at rest available
- **Automatic scaling** - no capacity planning needed

### **EFS Performance & Storage Classes:**

**Scale Capabilities:**
- **1000s of concurrent NFS clients**
- **10+ GB/s throughput**
- **Petabyte-scale** automatic growth

**Performance Modes (set at creation):**
- **General Purpose (default):** Latency-sensitive use cases
- **Max I/O:** Higher latency/throughput for highly parallel workloads

**Throughput Modes:**
- **Bursting:** 1 TB = 50MiB/s + burst to 100MiB/s
- **Provisioned:** Set throughput regardless of storage size
- **Elastic:** Auto-scales throughput (up to 3GiB/s reads, 1GiB/s writes)

**Storage Tiers:**
- **Standard:** Frequently accessed files
- **Infrequent Access (EFS-IA):** Lower storage cost, retrieval fees
- **Archive:** Rarely accessed (few times yearly), 50% cheaper
- **Lifecycle policies** available for automatic tier transitions

**Availability Options:**
- **Standard:** Multi-AZ (production)
- **One Zone:** Single AZ (development, 90%+ cost savings)

## **Storage Comparison Summary**

### **EBS vs EFS vs Instance Store:**

| Feature | EBS | EFS | Instance Store |
|---------|-----|-----|----------------|
| **Attachment** | One instance (except multi-attach) | Multiple instances across AZs | Single instance only |
| **Availability Zone** | Locked to specific AZ | Multi-AZ | Single AZ |
| **Performance** | Good network performance | Shared network performance | Highest I/O performance |
| **Persistence** | Persistent | Persistent | Ephemeral |
| **Use Cases** | Boot volumes, databases | Shared file systems, WordPress | High-performance computing, cache |
| **Cost** | Moderate | Higher (3x gp2) | Included with instance |
| **Migration** | Snapshot & restore | Native multi-AZ | Manual backup required |

**Key Decision Factors:**
- **EBS:** Single instance, persistent storage, boot volumes
- **EFS:** Multiple instances, shared file system, Linux only
- **Instance Store:** Maximum performance, temporary storage, high-risk tolerance